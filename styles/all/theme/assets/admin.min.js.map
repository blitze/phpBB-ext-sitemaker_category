{"version":3,"sources":["admin.min.js"],"names":["$","window","document","undefined","ready","ajaxUrl","groupId","lang","Twig","dButtons","groupAdmin","dialogConfirmDelete","currentGroupTitle","extendFunction","value","ajaxSend","event","xhr","settings","url","indexOf","iconPicker","selector","onSelect","item","iconClass","id","parentsUntil","parent","attr","substring","treeBuilder","cat_icon","groupDivObj","on","e","this","children","removeClass","addClass","preventDefault","element","prev","find","text","inlineGroupForm","show","appendTo","val","focus","select","end","dialog","buttons","hide","editForm","dialogConfirm","fields","itemId","itemTitle","click","slideToggle","button","getJSON","data","html","title","remove","append","submit","trigger","focusout","groupTitle","post","group","name","resp","up","down","next","length","location","reload","cancel","autoOpen","modal","width","jQuery"],"mappings":"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","file":"admin.min.js","sourcesContent":[";(function($, window, document, undefined) {\n\t'use strict';\n\n\t$(document).ready(function() {\n\t\tvar ajaxUrl = window.ajaxUrl || '';\n\t\tvar groupId = window.groupId || 0;\n\t\tvar lang = window.lang || {};\n\t\tvar Twig = window.Twig || {};\n\n\t\tvar dButtons = {};\n\t\tvar groupAdmin = {};\n\t\tvar dialogConfirmDelete = {};\n\t\tvar currentGroupTitle = '';\n\n\t\tTwig.extendFunction('lang', function(value) {\n\t\t\treturn (typeof lang[value] !== 'undefined') ? lang[value] : value;\n\t\t});\n\n\t\t// add group id to ajax requests\n\t\t$(document).ajaxSend(function(event, xhr, settings) {\n\t\t\tsettings.url += (settings.url.indexOf('?') >= 0) ? '&' : '?';\n\t\t\tsettings.url += 'group=' + groupId;\n\t\t});\n\n\t\t// Init icon picker\n\t\t$('.items-list').iconPicker({\n\t\t\tselector: '.icon-select',\n\t\t\tonSelect: function(item, iconClass) {\n\t\t\t\tvar id = item.parentsUntil('li').parent().attr('id').substring(5);\n\t\t\t\tgroupAdmin.treeBuilder('updateItem', {'cat_icon': iconClass}, id);\n\t\t\t}\n\t\t});\n\n\t\t// group list\n\t\tvar groupDivObj = $('#sm-groups')\n\t\t\t.on('click', '.group-option', function(e) {\n\t\t\t\tgroupId = +$(this).parent().attr('id').substring(6);\n\t\t\t\t$(this).parent().parent().children().removeClass('row3 current-group');\n\t\t\t\t$(this).parent().addClass('row3 current-group');\n\t\t\t\tgroupAdmin.treeBuilder('getItems');\n\t\t\t\te.preventDefault();\n\t\t\t})\n\t\t\t.on('click', '.group-edit', function(e) {\n\t\t\t\tvar element = $(this).parent().prev().removeClass('group-option').parent().removeClass('current-group').find('.group-editable');\n\t\t\t\tcurrentGroupTitle = element.text();\n\t\t\t\tinlineGroupForm.show().appendTo(element.text('')).children(':input').val(currentGroupTitle).focus().select().end();\n\t\t\t\te.preventDefault();\n\t\t\t})\n\t\t\t.on('click', '.group-delete', function(e) {\n\t\t\t\tdialogConfirmDelete.dialog({buttons: dButtons}).dialog('open');\n\t\t\t\te.preventDefault();\n\t\t\t});\n\n\t\tvar inlineGroupForm = $('<form id=\"inline-group-form\"><input type=\"text\" id=\"inline-group-edit\" value=\"\" /></form>').hide().appendTo($('body'));\n\n\t\t// manage group items\n\t\tgroupAdmin = $('#nested-tree').treeBuilder({\n\t\t\tajaxUrl: ajaxUrl,\n\t\t\teditForm: '#edit-group-item-form',\n\t\t\tdialogConfirm: '#dialog-confirm-group-item',\n\t\t\tfields: {\n\t\t\t\titemId: 'cat_id',\n\t\t\t\titemTitle: 'cat_name'\n\t\t\t}\n\t\t});\n\n\t\t$('.toggle-view').click(function(e) {\n\t\t\t$($(this).attr('href')).slideToggle();\n\t\t\te.preventDefault();\n\t\t});\n\n\t\t// add new group\n\t\t$('#add-group').button().click(function(e) {\n\t\t\tgroupId = 0;\n\t\t\t$.getJSON(ajaxUrl + 'add_group', function(data) {\n\t\t\t\tif (data.id === null) {\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tgroupId = data.id;\n\n\t\t\t\tvar html = '<li id=\"group-' + groupId + '\" class=\"row3 current-group\">';\n\t\t\t\thtml += '<a href=\"#\" class=\"group-option\"><span class=\"group-editable\">' + data.title + '</span></a>';\n\t\t\t\thtml += '<div class=\"group-actions\">';\n\t\t\t\thtml += '<a href=\"#\" class=\"group-delete left\" title=\"' + lang.remove + '\"><span class=\"ui-icon ui-icon-trash\"></span></a>';\n\t\t\t\thtml += '</span></li>';\n\t\t\t\tgroupDivObj.children('li').removeClass('row3 current-group');\n\t\t\t\tgroupDivObj.append(html);\n\n\t\t\t\tgroupAdmin.show().treeBuilder('getItems');\n\t\t\t});\n\n\t\t\te.preventDefault();\n\t\t});\n\n\t\t$('#inline-group-form').submit(function(e) {\n\t\t\te.preventDefault();\n\t\t\t$(this).children('#inline-group-edit').trigger('blur');\n\t\t});\n\n\t\t$('#inline-group-edit').focusout(function(e) {\n\t\t\tvar groupTitle = $(this).val();\n\t\t\tvar element = $(this).val('').parent().parent();\n\n\t\t\tif (groupId && groupTitle && groupTitle !== currentGroupTitle) {\n\t\t\t\t$.post(ajaxUrl + 'edit_group', {'title': groupTitle}, function(group) {\n\t\t\t\t\tif (group.name) {\n\t\t\t\t\t\telement.text(group.name);\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t} else {\n\t\t\t\tgroupTitle = currentGroupTitle;\n\t\t\t}\n\n\t\t\tinlineGroupForm.hide().appendTo($('body'));\n\t\t\telement.text(groupTitle).parent().addClass('group-option').parent().addClass('current-group');\n\t\t\te.preventDefault();\n\t\t});\n\n\t\tdButtons[lang.remove] = function() {\n\t\t\tif (groupId) {\n\t\t\t\t$.getJSON(ajaxUrl + 'delete_group', function(resp) {\n\t\t\t\t\tif (resp.id === groupId) {\n\t\t\t\t\t\tvar group = $('#group-' + groupId);\n\t\t\t\t\t\tvar up = group.prev();\n\t\t\t\t\t\tvar down = group.next();\n\n\t\t\t\t\t\tif (up.length) {\n\t\t\t\t\t\t\tup.find('.group-option').trigger('click');\n\t\t\t\t\t\t} else if (down.length) {\n\t\t\t\t\t\t\tdown.find('.group-option').trigger('click');\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\twindow.location.reload(false);\n\t\t\t\t\t\t}\n\t\t\t\t\t\tgroup.remove();\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t}\n\t\t\t$(this).dialog('close');\n\t\t};\n\n\t\tdButtons[lang.cancel] = function() {\n\t\t\t$(this).dialog('close');\n\t\t};\n\n\t\tdialogConfirmDelete = $('#dialog-confirm-group').dialog({\n\t\t\tautoOpen: false,\n\t\t\tmodal: true,\n\t\t\twidth: 'auto',\n\t\t\tshow: 'slide',\n\t\t\thide: 'slide'\n\t\t});\n\n\t\tif (groupId) {\n\t\t\tgroupAdmin.show();\n\t\t}\n\t});\n})(jQuery, window, document);"]}